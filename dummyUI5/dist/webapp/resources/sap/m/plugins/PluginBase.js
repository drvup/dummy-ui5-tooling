/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element"],function(t){"use strict";var e=t.extend("sap.m.plugins.PluginBase",{metadata:{abstract:true,library:"sap.m",properties:{enabled:{type:"boolean",defaultValue:true}}}});var i={};e.setConfig=function(t,n){var a=typeof n=="function"?n.getMetadata().getName():e.getMetadata().getName();Object.assign(i[a]=i[a]||{},t)};e.getPlugin=function(t,e){return t.getDependents().find(function(t){return t.isA(e)})};e.prototype.init=function(){this._bIsActive=false};e.prototype.isActive=function(){return this._bIsActive};e.prototype.getControl=function(){var t=this.getParent();if(t){var e="get"+this.getMetadata().getName().split(".").pop()+"PluginOwner";t=t[e]?t[e](this):t}return t};e.prototype.getControlPluginConfig=function(t,n,a,r){var o=this.getControl();if(!o){return n}var s=this.getMetadata().getName();var p=o.getMetadata().getName();var c=i[s]||{};var l=c[p]||{};var u=function(e){return typeof e[t]=="function"?e[t].call(e,a,r):e[t]};if(t in l){return u(l)}for(var f in c){if(o.isA(f)&&t in c[f]){return u(c[f])}}var h=e.getMetadata().getName();var g=i[h]||{};var v=g[p]||{};if(t in v){return u(v)}for(var f in g){if(o.isA(f)&&t in g[f]){return u(g[f])}}return n};e.prototype.isApplicable=function(t){return t.isA&&t.isA("sap.ui.core.Control")};e.prototype.onActivate=function(t){};e.prototype.onDeactivate=function(t){};e.prototype.setParent=function(e){if(this.getEnabled()&&this.getControl()){this._deactivate()}t.prototype.setParent.apply(this,arguments);var i=this.getControl();if(i instanceof Promise){i.then(this._checkApplicable.bind(this))}else{this._checkApplicable()}return this};e.prototype.setEnabled=function(t){var e=this.getEnabled();this.setProperty("enabled",t,true);var i=this.getEnabled();if(i!=e&&this.getControl()){if(i){this._activate()}else{this._deactivate()}}return this};e.prototype.setProperty=function(e,i,n){n=n||(this.getMetadata().getProperty(e).appData||{}).invalidate===false;return t.prototype.setProperty.call(this,e,i,n)};e.prototype._checkApplicable=function(){var t=this.getControl();if(t&&this.getEnabled()){if(!this.isApplicable(t)){throw new Error(this+" is not applicable to "+t)}else{this._activate()}}};e.prototype._activate=function(){if(!this.isActive()){this.getControlPluginConfig("onActivate",undefined,this.getControl(),this);this.onActivate(this.getControl());this._bIsActive=true}};e.prototype._deactivate=function(){if(this.isActive()){this.getControlPluginConfig("onDeactivate",undefined,this.getControl(),this);this.onDeactivate(this.getControl());this._bIsActive=false}};return e});