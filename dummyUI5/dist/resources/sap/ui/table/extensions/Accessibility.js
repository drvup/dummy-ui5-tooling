/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./ExtensionBase","./AccessibilityRender","../utils/TableUtils","../library","sap/ui/core/Control","sap/ui/Device","sap/ui/thirdparty/jquery"],function(e,t,a,r,i,l,o){"use strict";var s=r.SelectionMode;var n=a.CELLTYPE;var u={getAccInfoOfControl:function(e){if(e&&typeof e.getAccessibilityInfo==="function"){if(typeof e.getVisible==="function"&&!e.getVisible()){return u._normalize({})}var t=e.getAccessibilityInfo();if(t){var a={};u._flatten(t,a);return a}}return null},_normalize:function(e){if(!e){return null}if(e._normalized){return e}e.role=e.role||"";e.type=e.type||"";e.description=e.description||"";e.enabled=e.enabled===true||e.enabled===false?e.enabled:null;e.editable=e.editable===true||e.editable===false?e.editable:null;e.children=e.children||[];e._normalized=true;return e},_flatten:function(e,t,a){a=a?a:0;u._normalize(e);if(a==0){u._normalize(t);t._descriptions=[]}t._descriptions.push(u._getFullDescription(e));e.children.forEach(function(e){if(!e.getAccessibilityInfo||e.getVisible&&!e.getVisible()){return}var r=e.getAccessibilityInfo();if(r){u._flatten(r,t,a+1)}});if(a==0){t.description=t._descriptions.join(" ").trim();t._descriptions=undefined}},_getFullDescription:function(e){var t=e.type+" "+e.description;if(e.enabled===false){t=t+" "+a.getResourceText("TBL_CTRL_STATE_DISABLED")}else if(e.editable===false){t=t+" "+a.getResourceText("TBL_CTRL_STATE_READONLY")}return t.trim()}};var c={getColumnIndexOfFocusedCell:function(e){var t=e.getTable();var r=a.getFocusedItemInfo(t);return r.cellInRow-(a.hasRowHeader(t)?1:0)},getInfoOfFocusedCell:function(e){var t=e.getTable();var r=t._getItemNavigation();var i=t.getDomRef();if(!e.getAccMode()||!i||!r){return null}var l=r.getFocusedDomRef();if(!l||l!==document.activeElement){return null}return a.getCellInfo(l)},getRelevantColumnHeaders:function(e,t){if(!e||!t){return[]}var r=a.getHeaderRowCount(e),i=t.getId(),l=[i];if(r>1){for(var o=1;o<r;o++){l.push(i+"_"+o)}var s=a.Column.getParentSpannedColumns(e,i);if(s&&s.length){for(var o=0;o<s.length;o++){var n=s[o].level;var u=s[o].column.getId();l[n]=n===0?u:u+"_"+n}}}return l},isHiddenCell:function(e,t){var r=a.Grouping.isInGroupHeaderRow(e);var i=a.Grouping.isInSummaryRow(e);var l=!!t&&!!t.hasStyleClass;var o=e.parent().hasClass("sapUiTableRowHidden");var s=e.hasClass("sapUiTableCellHidden");var n=r&&l&&t.hasStyleClass("sapUiAnalyticalTableGroupCellHidden");var u=i&&l&&t.hasStyleClass("sapUiAnalyticalTableSumCellHidden");return o||s||n||u},isTreeColumnCell:function(e,t){return a.Grouping.isTreeMode(e.getTable())&&t.hasClass("sapUiTableCellFirst")},getColumnTooltip:function(e){if(!e){return null}var t=e.getTooltip_AsString();if(t){return t}var a=e.getLabel();if(a instanceof i){t=a.getTooltip_AsString()}if(t){return t}return null},updateRowColCount:function(e){var t=e.getTable(),r=t._getItemNavigation(),i=false,l=false,o=false,s=a.hasRowHeader(t),n=a.hasRowActions(t);if(r){var u=c.getColumnIndexOfFocusedCell(e)+1+(s?1:0);var d=a.getRowIndexOfFocusedCell(t)+t._getFirstRenderedRowIndex()+1;var E=a.getVisibleColumnCount(t)+(s?1:0)+(n?1:0);var f=a.isNoDataVisible(t)?0:Math.max(t._getTotalRowCount(),t._getRowCounts().count);i=e._iLastRowNumber!=d||e._iLastRowNumber==d&&e._iLastColumnNumber==u;l=e._iLastColumnNumber!=u;o=e._iLastRowNumber==null&&e._iLastColumnNumber==null;t.$("rownumberofrows").text(i&&d>0?a.getResourceText("TBL_ROW_ROWCOUNT",[d,f]):" ");t.$("colnumberofcols").text(l?a.getResourceText("TBL_COL_COLCOUNT",[u,E]):" ");t.$("ariacount").text(o?a.getResourceText("TBL_DATA_ROWS_COLS",[f,E]):" ");e._iLastRowNumber=d;e._iLastColumnNumber=u}return{rowChange:i,colChange:l,initial:o}},cleanupCellModifications:function(e){if(e._cleanupInfo){e._cleanupInfo.cell.attr(e._cleanupInfo.attr);e._cleanupInfo=null}},storeDefaultsBeforeCellModifications:function(e,t,a,r){e._cleanupInfo={cell:t,attr:{"aria-labelledby":a&&a.length?a.join(" "):null,"aria-describedby":r&&r.length?r.join(" "):null}}},performCellModifications:function(e,t,r,i,l,o,n,u){c.storeDefaultsBeforeCellModifications(e,t,r,i);var d=c.updateRowColCount(e);var E=e.getTable();E.$("cellacc").text(n||" ");if(u){u(l,o,d.rowChange,d.colChange,d.initial)}var f="";if(d.initial){f=E.getId()+"-ariacount";if(E.getSelectionMode()!==s.None){f=f+" "+E.getId()+"-ariaselection"}}if(l&&l.length){f=f+" "+l.join(" ")}if(d.initial||d.rowChange){if(a.hasRowNavigationIndicators(E)){var T=a.getCellInfo(t);if(T.type!==a.CELLTYPE.COLUMNHEADER&&T.type!==a.CELLTYPE.COLUMNROWHEADER){var g=E.getRows()[T.rowIndex].getAggregation("_settings");if(g.getNavigated()){f=f+" "+E.getId()+"-rownavigatedtext"}}}}t.attr({"aria-labelledby":f?f:null,"aria-describedby":o&&o.length?o.join(" "):null})},modifyAccOfDATACELL:function(e){var t=this.getTable();var r=t.getId();var i=t._getItemNavigation();var l=e.cell;if(!i){return}var o=a.getRowIndexOfFocusedCell(t),s=c.getColumnIndexOfFocusedCell(this),n=a.getRowColCell(t,o,s,false),E=null,f=n.row,T=f.getId(),g=c.isHiddenCell(l,n.cell),p=c.isTreeColumnCell(this,l),b=c.getAriaAttributesFor(this,d.ELEMENTTYPES.DATACELL,{index:s,column:n.column,fixed:a.isFixedColumn(t,s)})["aria-labelledby"]||[],h=[],C=[r+"-rownumberofrows",r+"-colnumberofcols"],R=f.isGroupHeader(),A=f.isSummary();if(R){C.push(r+"-ariarowgrouplabel");C.push(T+"-groupHeader")}else if(f.isTotalSummary()){C.push(r+"-ariagrandtotallabel")}else if(f.isGroupSummary()){C.push(r+"-ariagrouptotallabel")}if(a.hasRowHighlights(t)&&!R&&!A){C.push(T+"-highlighttext")}C=C.concat(b);if(!g){E=u.getAccInfoOfControl(n.cell);C.push(E?r+"-cellacc":n.cell.getId());if(a.getInteractiveElements(l)!==null){C.push(r+"-toggleedit")}if(a.Grouping.isTreeMode(t)&&l.parent().attr("aria-selected")==="true"){C.push(r+"-ariarowselected")}}var v=E?E.description:" ";if(p&&!g){var m=c.getAriaAttributesFor(this,d.ELEMENTTYPES.TREEICON,{row:n.row});if(m&&m["aria-label"]){v=m["aria-label"]+" "+v}}c.performCellModifications(this,l,b,null,C,h,v,function(e,r,i,o,s){var n=l.find(".sapUiTableTreeIcon").not(".sapUiTableTreeIconLeaf").length==1;if((n||R)&&(i||o)){r.push(t.getId()+(!f.isExpanded()?"-rowexpandtext":"-rowcollapsetext"))}else if(!g&&!R&&!A&&a.isRowSelectionAllowed(t)&&i){e.push(T+"-rowselecttext")}})},modifyAccOfROWHEADER:function(e){var t=this.getTable();var r=t.getId();var i=e.cell;var l=t.getRows()[e.rowIndex];var o=l.getId();var s=c.getAriaAttributesFor(this,d.ELEMENTTYPES.ROWHEADER)["aria-labelledby"]||[];var n=s.concat([r+"-rownumberofrows",r+"-colnumberofcols"]);if(!l.isSummary()&&!l.isGroupHeader()&&!l.isContentHidden()){n.push(o+"-rowselecttext");if(a.hasRowHighlights(t)){n.push(o+"-highlighttext")}}if(l.isGroupHeader()){n.push(r+"-ariarowgrouplabel");n.push(o+"-groupHeader");n.push(r+(l.isExpanded()?"-rowcollapsetext":"-rowexpandtext"))}if(l.isTotalSummary()){n.push(r+"-ariagrandtotallabel")}else if(l.isGroupSummary()){n.push(r+"-ariagrouptotallabel")}c.performCellModifications(this,i,s,null,n,null,null)},modifyAccOfCOLUMNHEADER:function(e){var t=this.getTable();var r=e.cell;var i=sap.ui.getCore().byId(r.attr("data-sap-ui-colid"));var o=c.getAriaAttributesFor(this,d.ELEMENTTYPES.COLUMNHEADER,{headerId:r.attr("id"),column:i,index:r.attr("data-sap-ui-colindex")});var s=c.getColumnTooltip(i);var n=[t.getId()+"-colnumberofcols"].concat(o["aria-labelledby"]);var u=e.columnSpan;if(u>1){n.push(t.getId()+"-ariacolspan");t.$("ariacolspan").text(a.getResourceText("TBL_COL_DESC_SPAN",[""+u]))}if(s){n.push(t.getId()+"-cellacc")}if(l.browser.msie){if(u<=1&&i&&i.getSorted()){n.push(t.getId()+(i.getSortOrder()==="Ascending"?"-ariacolsortedasc":"-ariacolsorteddes"))}}if(u<=1&&i&&i.getFiltered()){n.push(t.getId()+"-ariacolfiltered")}if(l.browser.msie){if(u<=1&&r.attr("aria-haspopup")==="menu"){n.push(t.getId()+"-ariacolmenu")}}c.performCellModifications(this,r,o["aria-labelledby"],o["aria-describedby"],n,o["aria-describedby"],s)},modifyAccOfCOLUMNROWHEADER:function(e){var t=this.getTable();var a=e.cell;var r=a.hasClass("sapUiTableSelAllVisible");var i=c.getAriaAttributesFor(this,d.ELEMENTTYPES.COLUMNROWHEADER,{enabled:r,checked:r&&!t.$().hasClass("sapUiTableSelAll")});var l=[t.getId()+"-colnumberofcols"].concat(i["aria-labelledby"]);c.performCellModifications(this,a,i["aria-labelledby"],i["aria-describedby"],l,i["aria-describedby"],null)},modifyAccOfROWACTION:function(e){var t=this.getTable();var r=t.getId();var i=e.cell;var l=t.getRows()[e.rowIndex];var o=l.getId();var s=c.isHiddenCell(i);var n=c.getAriaAttributesFor(this,d.ELEMENTTYPES.ROWACTION)["aria-labelledby"]||[];var u=[r+"-rownumberofrows",r+"-colnumberofcols"].concat(n);var E=[];if(l.isGroupHeader()){u.push(r+"-ariarowgrouplabel");u.push(o+"-groupHeader");u.push(r+(l.isExpanded()?"-rowcollapsetext":"-rowexpandtext"))}if(l.isTotalSummary()){u.push(r+"-ariagrandtotallabel")}else if(l.isGroupSummary()){u.push(r+"-ariagrouptotallabel")}if(!l.isSummary()&&!l.isGroupHeader()&&i.attr("aria-selected")==="true"){u.push(r+"-ariarowselected")}if(a.hasRowHighlights(t)&&!l.isGroupHeader()&&!l.isSummary()){u.push(o+"-highlighttext")}var f="";if(!s){var T=l.getRowAction();if(T){var g=T.getAccessibilityInfo();if(g){u.push(r+"-cellacc");f=g.description;if(a.getInteractiveElements(i)!==null){E.push(r+"-toggleedit")}}}}c.performCellModifications(this,i,n,[],u,E,f)},getAriaAttributesFor:function(e,t,r){var l={},o=e.getTable(),n=o.getId();function u(e,t,r,i){var o="";if(r&&i){o="overlay,nodata"}else if(r&&!i){o="overlay"}else if(!r&&i){o="nodata"}var s=false;if(r&&e.getShowOverlay()||i&&a.isNoDataVisible(e)){s=true}if(s){l["aria-hidden"]="true"}if(o){l["data-sap-ui-table-acc-covered"]=o}}switch(t){case d.ELEMENTTYPES.COLUMNROWHEADER:var E=o._getSelectionPlugin().getRenderConfig();if(E.headerSelector.visible){if(E.headerSelector.type==="toggle"){l["role"]=["checkbox"];if(r&&r.enabled){l["aria-checked"]=r.checked?"true":"false"}}else if(E.headerSelector.type==="clear"){l["role"]=["button"];if(!r||!r.enabled){l["aria-disabled"]="true"}}}if(!o._getShowStandardTooltips()&&E.headerSelector.type==="toggle"){l["aria-labelledby"]=[n+"-ariaselectall"]}break;case d.ELEMENTTYPES.ROWHEADER:l["role"]="gridcell";l["aria-colindex"]=1;break;case d.ELEMENTTYPES.ROWACTION:l["role"]="gridcell";l["aria-colindex"]=o._getVisibleColumns().length+1+(a.hasRowHeader(o)?1:0);l["aria-labelledby"]=[n+"-rowacthdr"];break;case d.ELEMENTTYPES.COLUMNHEADER:var f=r&&r.column;var T=r&&r.colspan;l["role"]="columnheader";l["aria-colindex"]=r.index+1+(a.hasRowHeader(o)?1:0);var g=[];if(r&&r.headerId){var p=c.getRelevantColumnHeaders(o,f);var b=p.indexOf(r.headerId);g=b>0?p.slice(0,b+1):[r.headerId]}for(var h=0;h<g.length;h++){g[h]=g[h]+"-inner"}l["aria-labelledby"]=g;if(r&&r.index<o.getComputedFixedColumnCount()){l["aria-labelledby"].push(n+"-ariafixedcolumn")}if(!T&&f&&f.getSorted()){l["aria-sort"]=f.getSortOrder()==="Ascending"?"ascending":"descending"}if(!T&&f&&f._menuHasItems()){l["aria-haspopup"]="menu"}break;case d.ELEMENTTYPES.DATACELL:l["role"]="gridcell";l["aria-colindex"]=r.index+1+(a.hasRowHeader(o)?1:0);var g=[],f=r&&r.column?r.column:null;if(f){g=c.getRelevantColumnHeaders(o,f);l["headers"]=g.join(" ");for(var h=0;h<g.length;h++){g[h]=g[h]+"-inner"}if(r&&r.fixed){g.push(n+"-ariafixedcolumn")}}l["aria-labelledby"]=g;break;case d.ELEMENTTYPES.ROOT:break;case d.ELEMENTTYPES.TABLE:l["role"]="presentation";u(o,l,true,true);break;case d.ELEMENTTYPES.CONTAINER:l["role"]="application";break;case d.ELEMENTTYPES.CONTENT:l["role"]=a.Grouping.isGroupMode(o)||a.Grouping.isTreeMode(o)?"treegrid":"grid";l["aria-labelledby"]=[].concat(o.getAriaLabelledBy());if(o.getTitle()){l["aria-labelledby"].push(o.getTitle().getId())}if(o.getSelectionMode()===s.MultiToggle){l["aria-multiselectable"]="true"}var C=o._getRowCounts();var R=a.hasFixedColumns(o);var A=C.fixedTop>0;var v=C.fixedBottom>0;var m=a.hasRowHeader(o);var L=a.hasRowActions(o);l["aria-owns"]=[n+"-table"];if(R){l["aria-owns"].push(n+"-table-fixed")}if(A){l["aria-owns"].push(n+"-table-fixrow");if(R){l["aria-owns"].push(n+"-table-fixed-fixrow")}}if(v){l["aria-owns"].push(n+"-table-fixrow-bottom");if(R){l["aria-owns"].push(n+"-table-fixed-fixrow-bottom")}}if(m){l["aria-owns"].push(n+"-sapUiTableRowHdrScr")}if(L){l["aria-owns"].push(n+"-sapUiTableRowActionScr")}l["aria-rowcount"]=o._getTotalRowCount();l["aria-colcount"]=o._getVisibleColumns().length+(m?1:0)+(L?1:0);if(o.isA("sap.ui.table.AnalyticalTable")){l["aria-roledescription"]=a.getResourceText("TBL_ANALYTICAL_TABLE_ROLE_DESCRIPTION")}break;case d.ELEMENTTYPES.TABLEHEADER:l["role"]="heading";l["aria-level"]="2";u(o,l,true,false);break;case d.ELEMENTTYPES.COLUMNHEADER_TBL:l["role"]="presentation";break;case d.ELEMENTTYPES.COLUMNHEADER_ROW:l["role"]="row";u(o,l,true,false);break;case d.ELEMENTTYPES.CREATIONROW_TBL:l["role"]="presentation";break;case d.ELEMENTTYPES.CREATIONROW:l["role"]="form";l["aria-labelledby"]=r.creationRow.getId()+"-label";u(o,l,true,false);break;case d.ELEMENTTYPES.ROWHEADER_COL:u(o,l,true,true);break;case d.ELEMENTTYPES.TH:l["role"]="presentation";l["scope"]="col";l["aria-hidden"]="true";break;case d.ELEMENTTYPES.TR:l["role"]="row";if(r.rowNavigated){l["aria-current"]=true}break;case d.ELEMENTTYPES.TREEICON:if(a.Grouping.isTreeMode(o)){l={"aria-label":"",title:"",role:""};if(o.getBinding()){if(r&&r.row){if(r.row.isExpandable()){var O=a.getResourceText(r.row.isExpanded()?"TBL_COLLAPSE":"TBL_EXPAND");if(o._getShowStandardTooltips()){l["title"]=O}else{l["aria-label"]=O}l["aria-expanded"]=""+!!r.row.isExpanded();l["aria-hidden"]="false";l["role"]="button"}else{l["aria-label"]=a.getResourceText("TBL_LEAF");l["aria-hidden"]="true"}}}}break;case d.ELEMENTTYPES.NODATA:l["role"]="gridcell";var w=o.getNoData();l["aria-labelledby"]=[w instanceof i?w.getId():n+"-noDataMsg"];u(o,l,true,false);break;case d.ELEMENTTYPES.OVERLAY:l["role"]="region";l["aria-labelledby"]=[].concat(o.getAriaLabelledBy());if(o.getTitle()){l["aria-labelledby"].push(o.getTitle().getId())}l["aria-labelledby"].push(n+"-ariainvalid");break;case d.ELEMENTTYPES.TABLEFOOTER:case d.ELEMENTTYPES.TABLESUBHEADER:u(o,l,true,false);break;case d.ELEMENTTYPES.ROWACTIONHEADER:l["aria-hidden"]="true";break;case"PRESENTATION":l["role"]="presentation";break}return l}};var d=e.extend("sap.ui.table.extensions.Accessibility",{_init:function(r,i,l){this._accMode=sap.ui.getCore().getConfiguration().getAccessibility();this._busyCells=[];a.addDelegate(r,this);e.enrich(r,t);return"AccExtension"},_debug:function(){this._ExtensionHelper=c;this._ACCInfoHelper=u},destroy:function(){this.getTable().removeEventDelegate(this);this._busyCells=[];e.prototype.destroy.apply(this,arguments)},getAriaAttributesFor:function(e,t){return c.getAriaAttributesFor(this,e,t)},onfocusin:function(e){var t=this.getTable();if(!t||a.getCellInfo(e.target).cell==null){return}if(t._mTimeouts._cleanupACCExtension){clearTimeout(t._mTimeouts._cleanupACCExtension);t._mTimeouts._cleanupACCExtension=null}this.updateAccForCurrentCell("Focus")},onfocusout:function(e){var t=this.getTable();if(!t){return}t._mTimeouts._cleanupACCExtension=setTimeout(function(){var e=this.getTable();if(!e){return}this._iLastRowNumber=null;this._iLastColumnNumber=null;c.cleanupCellModifications(this);e._mTimeouts._cleanupACCExtension=null}.bind(this),100)}});d.ELEMENTTYPES={DATACELL:"DATACELL",COLUMNHEADER:"COLUMNHEADER",ROWHEADER:"ROWHEADER",ROWACTION:"ROWACTION",COLUMNROWHEADER:"COLUMNROWHEADER",ROOT:"ROOT",CONTAINER:"CONTAINER",CONTENT:"CONTENT",TABLE:"TABLE",TABLEHEADER:"TABLEHEADER",TABLEFOOTER:"TABLEFOOTER",TABLESUBHEADER:"TABLESUBHEADER",COLUMNHEADER_TBL:"COLUMNHEADER_TABLE",COLUMNHEADER_ROW:"COLUMNHEADER_ROW",CREATIONROW_TBL:"CREATIONROW_TABLE",CREATIONROW:"CREATIONROW",ROWHEADER_COL:"ROWHEADER_COL",TH:"TH",TR:"TR",TREEICON:"TREEICON",ROWACTIONHEADER:"ROWACTIONHEADER",NODATA:"NODATA",OVERLAY:"OVERLAY"};d.prototype.getAccMode=function(){return this._accMode};d.prototype._updateAriaRowIndices=function(){if(!this._accMode){return}var e=this.getTable();var t=e.getRows();var a,r;for(r=0;r<t.length;r++){a=t[r];a.getDomRefs(true).row.attr("aria-rowindex",a.getIndex()+1)}};d.prototype._updateAriaRowCount=function(){var e=this.getTable();var t=e.$("sapUiTableGridCnt");if(t){t.attr("aria-rowcount",e._getTotalRowCount())}};d.prototype.updateAccForCurrentCell=function(e){if(!this._accMode||!this.getTable()._getItemNavigation()){return}if(e==="Focus"||e===a.RowsUpdateReason.Expand||e===a.RowsUpdateReason.Collapse){c.cleanupCellModifications(this)}var t=this.getTable();var r=c.getInfoOfFocusedCell(this);var i;if(!r||!r.isOfType(n.ANY)){return}if(r.isOfType(n.DATACELL)){i=d.ELEMENTTYPES.DATACELL}else if(r.isOfType(n.COLUMNHEADER)){i=d.ELEMENTTYPES.COLUMNHEADER}else if(r.isOfType(n.ROWHEADER)){i=d.ELEMENTTYPES.ROWHEADER}else if(r.isOfType(n.ROWACTION)){i=d.ELEMENTTYPES.ROWACTION}else if(r.isOfType(n.COLUMNROWHEADER)){i=d.ELEMENTTYPES.COLUMNROWHEADER}if(!c["modifyAccOf"+i]){return}if(e!=="Focus"&&e!==a.RowsUpdateReason.Expand&&e!==a.RowsUpdateReason.Collapse){if(r.isOfType(n.DATACELL|n.ROWHEADER|n.ROWACTION)){if(l.browser.msie){if(t._mTimeouts._cleanupACCCellBusy){clearTimeout(t._mTimeouts._cleanupACCCellBusy);t._mTimeouts._cleanupACCCellBusy=null}t._mTimeouts._cleanupACCCellBusy=setTimeout(function(){for(var e=0;e<this._busyCells.length;e++){this._busyCells[e].removeAttr("aria-hidden");this._busyCells[e].removeAttr("aria-busy")}t._mTimeouts._cleanupACCCellBusy=null;this._busyCells=[]}.bind(this),100);r.cell.attr("aria-busy","true");this._busyCells.push(r.cell)}else{r.cell.attr("role","status");r.cell.attr("role","gridcell")}}else{return}}c["modifyAccOf"+i].apply(this,[r])};d.prototype.updateAriaStateOfColumn=function(e){if(!this._accMode){return}var t=c.getAriaAttributesFor(this,d.ELEMENTTYPES.COLUMNHEADER,{headerId:e.getId(),column:e,index:this.getTable().indexOfColumn(e)});var a=c.getRelevantColumnHeaders(this.getTable(),e);for(var r=0;r<a.length;r++){var i=o(document.getElementById(a[r]));if(!i.attr("colspan")){i.attr({"aria-sort":t["aria-sort"]||null})}}};d.prototype.updateRowTooltips=function(e,t,r){if(!this._accMode){return}var i=this.getTable();var l=!e.isEmpty()&&!e.isGroupHeader()&&!e.isSummary()&&i._getShowStandardTooltips();if(t.row){if(l&&a.isRowSelectionAllowed(i)&&!t.row.hasClass("sapUiTableRowHidden")){t.row.attr("title",r)}else{t.row.removeAttr("title")}}if(t.rowSelector){if(l&&a.isRowSelectorSelectionAllowed(i)){t.rowSelector.attr("title",r)}else{t.rowSelector.removeAttr("title")}}if(t.rowScrollPart){var o=t.rowScrollPart.add(t.rowFixedPart).add(t.rowActionPart);if(l&&a.isRowSelectionAllowed(i)){o.attr("title",r)}else{o.removeAttr("title")}}};d.prototype.updateSelectionStateOfRow=function(e){if(!this._accMode){return}var t=e.getDomRefs(true);var r="";var i="";if(!e.isEmpty()&&!e.isGroupHeader()&&!e.isSummary()){var l=this.getAriaTextsForSelectionMode(true);var o=this.getTable();var s=o._getSelectionPlugin().isIndexSelected(e.getIndex());if(t.row){t.row.add(t.row.children(".sapUiTableCell")).attr("aria-selected",s?"true":"false")}if(!s){r=l.keyboard["rowSelect"];i=l.mouse["rowSelect"]}else{r=a.getResourceText("TBL_ROW_DESC_SELECTED")+" "+l.keyboard["rowDeselect"];i=l.mouse["rowDeselect"]}}if(t.rowSelectorText){t.rowSelectorText.text(r)}this.updateRowTooltips(e,t,i)};d.prototype.updateAriaExpandAndLevelState=function(e){if(!this._accMode){return}var t=e.getDomRefs(true);var a=t.row.find(".sapUiTableTreeIcon");if(t.rowHeaderPart){t.rowHeaderPart.attr({"aria-haspopup":e.isGroupHeader()?"menu":null})}t.row.attr({"aria-expanded":e.isExpandable()?e.isExpanded()+"":null,"aria-level":e.getLevel()});if(a){a.attr(c.getAriaAttributesFor(this,d.ELEMENTTYPES.TREEICON,{row:e}))}};d.prototype.updateAriaStateOfRowHighlight=function(e){if(!this._accMode||!e){return}var t=e._getRow();var a=t?t.getDomRef("highlighttext"):null;if(a){a.innerText=e._getHighlightText()}};d.prototype._updateAriaStateOfNavigatedRow=function(e){if(!this._accMode||!e){return}var t=e._getRow();var a=e.getNavigated();t.getDomRefs(true).row.attr("aria-current",a?true:null)};d.prototype.updateAriaStateForOverlayAndNoData=function(){var e=this.getTable();if(!e||!e.getDomRef()||!this._accMode){return}if(e.getShowOverlay()){e.$().find("[data-sap-ui-table-acc-covered*='overlay']").attr("aria-hidden","true")}else{e.$().find("[data-sap-ui-table-acc-covered*='overlay']").removeAttr("aria-hidden");if(a.isNoDataVisible(e)){e.$().find("[data-sap-ui-table-acc-covered*='nodata']").attr("aria-hidden","true")}else{e.$().find("[data-sap-ui-table-acc-covered*='nodata']").removeAttr("aria-hidden")}}};d.prototype.getAriaTextsForSelectionMode=function(e,t){var r=this.getTable();if(!t){t=r.getSelectionMode()}var i=r._getShowStandardTooltips();var l={mouse:{rowSelect:"",rowDeselect:""},keyboard:{rowSelect:"",rowDeselect:""}};var o=r._getSelectionPlugin().getSelectedCount();if(t===s.Single){l.mouse.rowSelect=i?a.getResourceText("TBL_ROW_SELECT"):"";l.mouse.rowDeselect=i?a.getResourceText("TBL_ROW_DESELECT"):"";l.keyboard.rowSelect=a.getResourceText("TBL_ROW_SELECT_KEY");l.keyboard.rowDeselect=a.getResourceText("TBL_ROW_DESELECT_KEY")}else if(t===s.MultiToggle){l.mouse.rowSelect=i?a.getResourceText("TBL_ROW_SELECT_MULTI_TOGGLE"):"";l.mouse.rowDeselect=i?a.getResourceText("TBL_ROW_DESELECT"):"";l.keyboard.rowSelect=a.getResourceText("TBL_ROW_SELECT_KEY");l.keyboard.rowDeselect=a.getResourceText("TBL_ROW_DESELECT_KEY");if(e===true&&o===0){l.mouse.rowSelect=i?a.getResourceText("TBL_ROW_SELECT"):""}}return l};d.prototype.setSelectAllState=function(e){var t=this.getTable();if(this._accMode&&t){t.$("selall").attr("aria-checked",e?"true":"false")}};d.prototype.addColumnHeaderLabel=function(e,t){var a=this.getTable();if(!this._accMode||!t.getAriaLabelledBy||!a){return}var r=a.getColumnHeaderVisible()?e.getId():null;if(!r){var i=e.getAggregation("label");if(i){r=i.getId()}}var l=t.getAriaLabelledBy();if(r&&l.indexOf(r)<0){t.addAriaLabelledBy(r)}};return d});